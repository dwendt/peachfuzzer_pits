<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://peachfuzzer.com/2012/Peach peach.xsd" author="Ditmar Wendt (dwn)">
    <!--  
      Quick ctrl+f for this file:
        TODO = "do this eventually maybe never"
        VERIFY = "we're doing something here but idk if we should"
        ??? = "what is this"

      This pit was made using a random tiny EXE that was a CTF challenge or something.
      It has four segments: .text, .rdata, .data, .rsrc

      Interesting directories it has are: Import, Debug, Data, Resource, Security

      It has no exports.

      TODO: peach can 
    -->
    <Defaults>
      <Blob lengthType="bits"></Blob>
    </Defaults>
    <!-- Define our file format DDL -->
    <DataModel name="FileData">
        <!-- DOS Magic Number, static, start of DOS header -->
        <Blob name="e_magic" length="16" valueType="hex" value="4D 5A" mutable="false" />
        <!-- ??? "bytes on last page of file"  -->
        <Blob name="e_cblp" length="16" valueType="hex" value="90 00" mutable="false" />
        <!-- ??? "pages in file" -->
        <Blob name="e_cp" length="16" valueType="hex" value="03 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_crlc" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_cparhdr" length="16" valueType="hex" value="04 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_minalloc" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_maxalloc" length="16" valueType="hex" value="FF FF" mutable="false" />
        <!-- ??? -->
        <Blob name="e_ss" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_sp" length="16" valueType="hex" value="B8 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_csum" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_ip" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_cs" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_lfarlc" length="16" valueType="hex" value="40 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_ovno" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_res" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- three shorts of zeroes... -->
        <Blob name="pad0" length="48" valueType="hex" value="00 00 00 00 00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_oemid" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_oeminfo" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- ??? -->
        <Blob name="e_res2" length="16" valueType="hex" value="00 00" mutable="false" />
        <!-- nine shorts of zero -->
        <Blob name="pad1" length="144" valueType="hex" value="00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00" mutable="false" />
        <!-- ??? the end of the DOS header! -->
        <Blob name="e_lfanew" length="32" valueType="hex" value="F0 00 00 00" mutable="false" />

        <!-- ??? "rich" header, other useless junk after DOS head -->
        <Blob name="garbage0" length="1408" valueType="hex" mutable="false" 
         value="0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68
69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F
74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20
6D 6F 64 65 2E 0D 0D 0A 24 00 00 00 00 00 00 00
73 EE 42 67 37 8F 2C 34 37 8F 2C 34 37 8F 2C 34
10 49 57 34 35 8F 2C 34 10 49 42 34 36 8F 2C 34
10 49 51 34 36 8F 2C 34 10 49 41 34 23 8F 2C 34
F4 80 71 34 34 8F 2C 34 37 8F 2D 34 19 8F 2C 34
10 49 5E 34 35 8F 2C 34 10 49 54 34 36 8F 2C 34
52 69 63 68 37 8F 2C 34 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"
         />


        <!-- here begins IMAGE_NT_HEADERS. magic num "PE\0\0" -->
        <Blob name="Signature" length="32" valueType="hex" value="50 45 00 00" mutable="false" />
        <!-- IMAGE_FILE_HEADER start -->
        <!-- 0x014C indicates it's an x86 Intel 386 binary -->
        <Blob name="Machine" length="16" valueType="hex" value="4C 01" mutable="false" />
        <!-- num of sections. decent for getting parser crashes -->
        <Number name="NumberOfSections" size="16" valueType="hex" value="04 00" />
        <Blob name="TimeDateStamp" length="32" valueType="hex" value="9C 27 A7 3E" mutable="false" />
        <!-- TODO: if there's symbols, this is non-zero... -->
        <Blob name="PointerToSymbolTable" length="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <!-- TODO: count for the above table. -->
        <Number name="NumberOfSymbols" valueType="hex" value="00 00 00 00" size="32" mutable="false" />
        <!-- self-descriptive -->
        <Number name="SizeOfOptionalHeader" size="16" valueType="hex" value="E0 00" />
        <!-- flags for the PE. this is a stripped exe file. https://msdn.microsoft.com/en-us/library/windows/desktop/ms680313(v=vs.85).aspx -->
        <Blob name="Characteristics" length="16" valueType="hex" value="0F 0D" mutable="false" />
        <!-- IMAGE_FILE_HEADER end -->

        <!-- IMAGE_OPTIONAL_HEADER start fml -->
        <!-- this value indicates PE32 format -->
        <Blob name="Magic" length="16" valueType="hex" value="0B 01" mutable="false" />        
        <Blob name="MajorLinkerVersion" length="8" valueType="hex" value="07" mutable="false" />    
        <Blob name="MinorLinkerVersion" length="8" valueType="hex" value="00" mutable="false" />  
        <!-- VERIFY: has the below ever crashed anything? -->
        <Number name="SizeOfCode" size="32" valueType="hex" value="00 0A 00 00" />  
        <Number name="SizeOfInitializedData" size="32" valueType="hex" value="00 0C 00 00" />
        <Number name="SizeOfUninitializedData" size="32" valueType="hex" value="00 00 00 00" />    
        <!-- TODO: try blob instead? -->
        <Number name="AddressOfEntryPoint" size="32" valueType="hex" value="C1 13 00 00" />   
        <!-- NOTE: if fuzzing a PE loader/mapper, this next block of shit should be fuzzed -->
        <Number name="BaseOfCode" size="32" valueType="hex" value="00 10 00 00" mutable="false" />   
        <Number name="BaseOfData" size="32" valueType="hex" value="00 20 00 00" mutable="false" />   
        <Number name="ImageBase" size="32" valueType="hex" value="00 00 40 00" />   
        <Number name="SectionAlignment" size="32" valueType="hex" value="00 10 00 00" mutable="false" /> 
        <Number name="FileAlignment" size="32" valueType="hex" value="00 02 00 00" mutable="false" />  

        <!-- version numbers? probably never interesting? -->
        <Number name="MajorOperatingSystemVersion" size="16" valueType="hex" value="05 00" mutable="false" />   
        <Number name="MinorOperatingSystemVersion" size="16" valueType="hex" value="01 00" mutable="false" />  
        <Number name="MajorImageVersion" size="16" valueType="hex" value="05 00" mutable="false" />  
        <Number name="MinorImageVersion" size="16" valueType="hex" value="01 00" mutable="false" />  
        <Number name="MajorSubsystemVersion" size="16" valueType="hex" value="04 00" mutable="false" />  
        <Number name="MinorSubsystemVersion" size="16" valueType="hex" value="00 00" mutable="false" />  
        <Number name="Win32VersionValue" size="32" valueType="hex" value="00 00 00 00" mutable="false" />  

        <!-- in-mem sizes? -->
        <Number name="SizeOfImage" size="32" valueType="hex" value="00 50 00 00" />  
        <Number name="SizeOfHeaders" size="32" valueType="hex" value="00 04 00 00" /> 

        <!-- this only needs to be valid for drivers and things loaded by kernel --> 
        <Number name="CheckSum" size="32" valueType="hex" value="BE 59 00 00" mutable="false" />  

        <!-- 'Windows GUI' flag -->
        <Blob name="Subsystem" length="16" valueType="hex" value="02 00" mutable="false" />  

        <!-- this is an exe, but these flags mean "terminal server aware" -->
        <Blob name="DllCharacteristics" length="16" valueType="hex" value="00 80" mutable="false" />  

        <!-- ??? is this stuff ever used -->
        <Number name="SizeOfStackReserve" size="32" valueType="hex" value="00 00 10 00" mutable="false" />  
        <Number name="SizeOfStackCommit" size="32" valueType="hex" value="00 10 00 00" mutable="false" />  
        <Number name="SizeOfHeapReserve" size="32" valueType="hex" value="00 00 10 00" mutable="false" />  
        <Number name="SizeOfHeapCommit" size="32" valueType="hex" value="00 10 00 00" mutable="false" />  
        <Blob name="LoaderFlags" length="32" valueType="hex" value="00 00 00 00" mutable="false" />  

        <!-- defines # of "data directory" entries to follow -->
        <Number name="NumberOfRvaAndSizes" size="32" valueType="hex" value="10 00 00 00" />  
        <!-- these tend to try and get resolved by a lot of stuff... -->
        <Number name="ExportRVA" size="32" valueType="hex" value="00 00 00 00" />  
        <Number name="ExportSize" size="32" valueType="hex" value="00 00 00 00" />
        <Number name="ImportRVA" size="32" valueType="hex" value="24 22 00 00" />  
        <Number name="ImportSize" size="32" valueType="hex" value="3C 00 00 00" /> 
        <Number name="ResourceRVA" size="32" valueType="hex" value="00 40 00 00" /> 
        <Number name="ResourceSize" size="32" valueType="hex" value="AC 01 00 00" /> 
        <Number name="ExceptionRVA" size="32" valueType="hex" value="00 00 00 00" /> 
        <Number name="ExceptionSize" size="32" valueType="hex" value="00 00 00 00" /> 
        <Number name="SecurityRVA" size="32" valueType="hex" value="00 98 13 00" /> 
        <Number name="SecuritySize" size="32" valueType="hex" value="20 1B 00 00" /> 
        <Number name="RelocationRVA" size="32" valueType="hex" value="00 00 00 00" /> 
        <Number name="RelocationSize" size="32" valueType="hex" value="00 00 00 00" /> 
        <Number name="DebugRVA" size="32" valueType="hex" value="E0 20 00 00" /> 
        <Number name="DebugSize" size="32" valueType="hex" value="1C 00 00 00" /> 

        <!-- bunch of meh trash -->
        <Number name="ArchitectureRVA" size="32" valueType="hex" value="00 00 00 00" mutable="false" /> 
        <Number name="ArchitectureSize" size="32" valueType="hex" value="00 00 00 00" mutable="false" /> 
        <Blob name="Reserved" length="64" valueType="hex" value="00 00 00 00 00 00 00 00" /> 
        <Number name="TLSRVA" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="TLSSize" size="32" valueType="hex" value="00 00 00 00" mutable="false" /> 
        <Number name="ConfigRVA" size="32" valueType="hex" value="10 21 00 00" mutable="false" />
        <Number name="ConfigSize" size="32" valueType="hex" value="40 00 00 00" mutable="false" />

        <!-- TODO: add this -->
        <Number name="BoundRVA" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="BoundSize" size="32" valueType="hex" value="00 00 00 00" mutable="false" />

        <!-- very often molested by ~forensics tools~ -->
        <Number name="ImportTableRVA" size="32" valueType="hex" value="00 20 00 00" />
        <Number name="ImportTableSize" size="32" valueType="hex" value="C0 00 00 00" />

        <!-- TODO: add this -->
        <Number name="DelayRVA" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="DelaySize" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="DotNetRVA" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="DotNetSize" size="32" valueType="hex" value="00 00 00 00" mutable="false" />

        <Blob name="pad2" length="64" valueType="hex" value="00 00 00 00 00 00 00 00" mutable="false" />  
        <!-- optional header done. finally. -->

        <!-- section header start~ -->
        <!-- char name[8] -->
        <Blob name="text_section_name" length="64" valueType="hex" value="2E 74 65 78 74 00 00 00" />
        <Number name="text_virtual_size" size="32" valueType="hex" value="32 08 00 00" />
        <Number name="text_virtual_addr" size="32" valueType="hex" value="00 10 00 00" />
        <Number name="text_raw_size" size="32" valueType="hex" value="00 0A 00 00" />
        <Number name="text_raw_addr" size="32" valueType="hex" value="00 04 00 00" />
        <Number name="text_reloc_addr" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <!-- ??? ptr to line numb debug info -->
        <Number name="text_linenums" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="text_relocnums" size="16" valueType="hex" value="00 00" mutable="false" />
        <Number name="text_linenumssize" size="16" valueType="hex" value="00 00" mutable="false" />
        <Number name="text_characteristics" size="32" valueType="hex" value="20 00 00 60" mutable="false" />

        <!-- section 2, rdata -->
        <Blob name="rdata_section_name" length="64" valueType="hex" value="2E 72 64 61 74 61 00 00" />
        <Number name="rdata_virtual_size" size="32" valueType="hex" value="44 06 00 00" />
        <Number name="rdata_virtual_addr" size="32" valueType="hex" value="00 20 00 00" />
        <Number name="rdata_raw_size" size="32" valueType="hex" value="00 08 00 00" />
        <Number name="rdata_raw_addr" size="32" valueType="hex" value="00 0E 00 00" />
        <Number name="rdata_reloc_addr" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="rdata_linenums" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="rdata_relocnums" size="16" valueType="hex" value="00 00" mutable="false" />
        <Number name="rdata_linenumssize" size="16" valueType="hex" value="00 00" mutable="false" />
        <Number name="rdata_characteristics" size="32" valueType="hex" value="40 00 00 40" mutable="false" />

        <!-- section 3, data -->
        <Blob name="data_section_name" length="64" valueType="hex" value="2E 64 61 74 61 00 00 00" />
        <Number name="data_virtual_size" size="32" valueType="hex" value="84 03 00 00" />
        <Number name="data_virtual_addr" size="32" valueType="hex" value="00 30 00 00" />
        <Number name="data_raw_size" size="32" valueType="hex" value="00 02 00 00" />
        <Number name="data_raw_addr" size="32" valueType="hex" value="00 16 00 00" />
        <Number name="data_reloc_addr" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="data_linenums" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="data_relocnums" size="16" valueType="hex" value="00 00" mutable="false" />
        <Number name="data_linenumssize" size="16" valueType="hex" value="00 00" mutable="false" />
        <Number name="data_characteristics" size="32" valueType="hex" value="40 00 00 C0" mutable="false" />

        <!-- section 3, rsrc -->
        <Blob name="rsrc_section_name" length="64" valueType="hex" value="2E 72 73 72 63 00 00 00" />
        <Number name="rsrc_virtual_size" size="32" valueType="hex" value="AC 01 00 00" />
        <Number name="rsrc_virtual_addr" size="32" valueType="hex" value="00 40 00 00" />
        <Number name="rsrc_raw_size" size="32" valueType="hex" value="00 02 00 00" />
        <Number name="rsrc_raw_addr" size="32" valueType="hex" value="00 18 00 00" />
        <Number name="rsrc_reloc_addr" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="rsrc_linenums" size="32" valueType="hex" value="00 00 00 00" mutable="false" />
        <Number name="rsrc_relocnums" size="16" valueType="hex" value="00 00" mutable="false" />
        <Number name="rsrc_linenumssize" size="16" valueType="hex" value="00 00" mutable="false" />
        <Number name="rsrc_characteristics" size="32" valueType="hex" value="40 00 00 30" mutable="false" />
        <!-- end of sections, previous characteristics was at offset 0x284.. .text starts at 0x400 -->


        <!-- alignment block from 0x288 - 0x400 -->
        <Blob name="padding_after_sections" length="3008" valueType="hex"
          value="00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
"
          mutable="false" />

        <!-- blobs for each section -->
        <Blob name="text_blob" length="20480" valueType="hex" 
          value="83 EC 0C 53 55 8B 6C 24 1C 8B 45 08 56 8B 35 AC
20 40 00 57 8B 7D 04 50 FF D6 8B 4D 0C 51 89 44
24 1C FF D6 50 89 44 24 24 E8 EA 00 00 00 8B 1D
0C 20 40 00 83 C4 0C 6A 00 68 00 00 00 10 6A 03
6A 00 6A 01 6A 02 57 89 44 24 40 FF D3 8B F0 83
FE FF 75 21 6A 01 FF 15 08 20 40 00 6A 00 68 00
00 00 10 6A 03 6A 00 6A 01 6A 02 57 FF D3 8B F0
83 FE FF 74 DF 8B 44 24 14 3D FF FF FF 7F 75 08
6A 02 6A 00 6A 00 EB 05 6A 00 6A 00 50 56 FF 15
00 20 40 00 8B 5C 24 18 33 FF 85 DB 76 33 83 C5
10 8B 45 00 8D 54 24 10 52 68 04 21 40 00 50 FF
15 B0 20 40 00 83 C4 0C 83 F8 01 75 28 8A 4C 24
10 8B 54 24 24 88 0C 17 03 F8 83 C5 04 3B FB 72
D0 8B 4C 24 24 6A 00 8D 44 24 14 50 53 51 56 FF
15 04 20 40 00 56 FF 15 10 20 40 00 8B 54 24 24
52 E8 1C 00 00 00 83 C4 04 5F 5E 5D 33 C0 5B 83
C4 0C C3 3B 0D 00 30 40 00 75 02 F3 C3 E9 B9 02
00 00 FF 25 B4 20 40 00 FF 25 A8 20 40 00 68 AB
15 40 00 E8 4D 04 00 00 A1 60 33 40 00 C7 04 24
2C 30 40 00 FF 35 5C 33 40 00 A3 2C 30 40 00 68
1C 30 40 00 68 20 30 40 00 68 18 30 40 00 FF 15
A0 20 40 00 83 C4 14 85 C0 A3 28 30 40 00 7D 08
6A 08 E8 69 03 00 00 59 C3 6A 10 68 C8 21 40 00
E8 57 05 00 00 33 DB 89 5D FC 64 A1 18 00 00 00
8B 70 04 89 5D E4 BF 74 33 40 00 53 56 57 FF 15
38 20 40 00 3B C3 74 19 3B C6 75 08 33 F6 46 89
75 E4 EB 10 68 E8 03 00 00 FF 15 08 20 40 00 EB
DA 33 F6 46 A1 70 33 40 00 3B C6 75 0A 6A 1F E8
0C 03 00 00 59 EB 3B A1 70 33 40 00 85 C0 75 2C
89 35 70 33 40 00 68 D4 20 40 00 68 CC 20 40 00
E8 DF 04 00 00 59 59 85 C0 74 17 C7 45 FC FE FF
FF FF B8 FF 00 00 00 E9 DD 00 00 00 89 35 34 30
40 00 A1 70 33 40 00 3B C6 75 1B 68 C8 20 40 00
68 C0 20 40 00 E8 A4 04 00 00 59 59 C7 05 70 33
40 00 02 00 00 00 39 5D E4 75 08 53 57 FF 15 3C
20 40 00 39 1D 80 33 40 00 74 19 68 80 33 40 00
E8 0D 04 00 00 59 85 C0 74 0A 53 6A 02 53 FF 15
80 33 40 00 A1 1C 30 40 00 8B 0D 8C 20 40 00 89
01 FF 35 1C 30 40 00 FF 35 20 30 40 00 FF 35 18
30 40 00 E8 88 FD FF FF 83 C4 0C A3 30 30 40 00
39 1D 24 30 40 00 75 37 50 FF 15 90 20 40 00 8B
45 EC 8B 08 8B 09 89 4D E0 50 51 E8 30 03 00 00
59 59 C3 8B 65 E8 8B 45 E0 A3 30 30 40 00 33 DB
39 1D 24 30 40 00 75 07 50 FF 15 98 20 40 00 39
1D 34 30 40 00 75 06 FF 15 9C 20 40 00 C7 45 FC
FE FF FF FF A1 30 30 40 00 E8 33 04 00 00 C3 66
81 3D 00 00 40 00 4D 5A 74 04 33 C0 EB 51 A1 3C
00 40 00 81 B8 00 00 40 00 50 45 00 00 75 EB 0F
B7 88 18 00 40 00 81 F9 0B 01 00 00 74 1B 81 F9
0B 02 00 00 75 D4 83 B8 84 00 40 00 0E 76 CB 33
C9 39 88 F8 00 40 00 EB 11 83 B8 74 00 40 00 0E
76 B8 33 C9 39 88 E8 00 40 00 0F 95 C1 8B C1 6A
01 A3 24 30 40 00 FF 15 64 20 40 00 6A FF FF 15
B8 20 40 00 59 59 A3 78 33 40 00 A3 7C 33 40 00
FF 15 5C 20 40 00 8B 0D 68 33 40 00 89 08 FF 15
58 20 40 00 8B 0D 64 33 40 00 89 08 A1 54 20 40
00 8B 00 A3 6C 33 40 00 E8 FA 01 00 00 E8 DF 03
00 00 83 3D 14 30 40 00 00 75 0C 68 71 17 40 00
FF 15 50 20 40 00 59 E8 9C 03 00 00 83 3D 10 30
40 00 FF 75 09 6A FF FF 15 4C 20 40 00 59 33 C0
C3 E8 AE 03 00 00 E9 9E FD FF FF 55 8B EC 81 EC
28 03 00 00 A3 40 31 40 00 89 0D 3C 31 40 00 89
15 38 31 40 00 89 1D 34 31 40 00 89 35 30 31 40
00 89 3D 2C 31 40 00 66 8C 15 58 31 40 00 66 8C
0D 4C 31 40 00 66 8C 1D 28 31 40 00 66 8C 05 24
31 40 00 66 8C 25 20 31 40 00 66 8C 2D 1C 31 40
00 9C 8F 05 50 31 40 00 8B 45 00 A3 44 31 40 00
8B 45 04 A3 48 31 40 00 8D 45 08 A3 54 31 40 00
8B 85 E0 FC FF FF C7 05 90 30 40 00 01 00 01 00
A1 48 31 40 00 A3 44 30 40 00 C7 05 38 30 40 00
09 04 00 C0 C7 05 3C 30 40 00 01 00 00 00 A1 00
30 40 00 89 85 D8 FC FF FF A1 04 30 40 00 89 85
DC FC FF FF FF 15 24 20 40 00 A3 88 30 40 00 6A
01 E8 72 03 00 00 59 6A 00 FF 15 28 20 40 00 68
FC 20 40 00 FF 15 2C 20 40 00 83 3D 88 30 40 00
00 75 08 6A 01 E8 4E 03 00 00 59 68 09 04 00 C0
FF 15 30 20 40 00 50 FF 15 34 20 40 00 C9 C3 CC
FF 25 A4 20 40 00 6A 14 68 E8 21 40 00 E8 EA 01
00 00 FF 35 7C 33 40 00 8B 35 7C 20 40 00 FF D6
59 89 45 E4 83 F8 FF 75 0C FF 75 08 FF 15 78 20
40 00 59 EB 61 6A 08 E8 0E 03 00 00 59 83 65 FC
00 FF 35 7C 33 40 00 FF D6 89 45 E4 FF 35 78 33
40 00 FF D6 89 45 E0 8D 45 E0 50 8D 45 E4 50 FF
75 08 E8 DD 02 00 00 89 45 DC FF 75 E4 8B 35 B8
20 40 00 FF D6 A3 7C 33 40 00 FF 75 E0 FF D6 83
C4 1C A3 78 33 40 00 C7 45 FC FE FF FF FF E8 09
00 00 00 8B 45 DC E8 A6 01 00 00 C3 6A 08 E8 9B
02 00 00 59 C3 FF 74 24 04 E8 58 FF FF FF F7 D8
1B C0 F7 D8 59 48 C3 56 57 B8 B8 21 40 00 BF B8
21 40 00 3B C7 8B F0 73 0F 8B 06 85 C0 74 02 FF
D0 83 C6 04 3B F7 72 F1 5F 5E C3 56 57 B8 C0 21
40 00 BF C0 21 40 00 3B C7 8B F0 73 0F 8B 06 85
C0 74 02 FF D0 83 C6 04 3B F7 72 F1 5F 5E C3 CC
FF 25 94 20 40 00 CC CC CC CC CC CC CC CC CC CC
8B 4C 24 04 66 81 39 4D 5A 74 03 33 C0 C3 8B 41
3C 03 C1 81 38 50 45 00 00 75 F0 33 C9 66 81 78
18 0B 01 0F 94 C1 8B C1 C3 CC CC CC CC CC CC CC
8B 44 24 04 8B 48 3C 03 C8 0F B7 41 14 53 56 0F
B7 71 06 33 D2 85 F6 57 8D 44 08 18 76 1E 8B 7C
24 14 8B 48 0C 3B F9 72 09 8B 58 08 03 D9 3B FB
72 0C 83 C2 01 83 C0 28 3B D6 72 E6 33 C0 5F 5E
5B C3 6A 08 68 08 22 40 00 E8 6E 00 00 00 83 65
FC 00 BA 00 00 40 00 52 E8 73 FF FF FF 59 85 C0
74 3D 8B 45 08 2B C2 50 52 E8 92 FF FF FF 59 59
85 C0 74 2B 8B 40 24 C1 E8 1F F7 D0 83 E0 01 C7
45 FC FE FF FF FF EB 20 8B 45 EC 8B 00 8B 00 33
C9 3D 05 00 00 C0 0F 94 C1 8B C1 C3 8B 65 E8 C7
45 FC FE FF FF FF 33 C0 E8 54 00 00 00 C3 FF 25
60 20 40 00 FF 25 48 20 40 00 CC CC 68 25 17 40
00 64 FF 35 00 00 00 00 8B 44 24 10 89 6C 24 10
8D 6C 24 10 2B E0 53 56 57 A1 00 30 40 00 31 45
FC 33 C5 50 89 65 E8 FF 75 F8 8B 45 FC C7 45 FC
FE FF FF FF 89 45 F8 8D 45 F0 64 A3 00 00 00 00
C3 8B 4D F0 64 89 0D 00 00 00 00 59 5F 5F 5E 5B
8B E5 5D 51 C3 FF 74 24 10 FF 74 24 10 FF 74 24
10 FF 74 24 10 68 03 11 40 00 68 00 30 40 00 E8
DC 00 00 00 83 C4 18 C3 56 68 00 00 03 00 68 00
00 01 00 33 F6 56 E8 D1 00 00 00 83 C4 0C 85 C0
74 0D 56 56 56 56 56 E8 BA 00 00 00 83 C4 14 5E
C3 33 C0 C3 55 8B EC 83 EC 10 A1 00 30 40 00 83
65 F8 00 83 65 FC 00 53 57 BF 4E E6 40 BB 3B C7
BB 00 00 FF FF 74 0D 85 C3 74 09 F7 D0 A3 04 30
40 00 EB 60 56 8D 45 F8 50 FF 15 40 20 40 00 8B
75 FC 33 75 F8 FF 15 14 20 40 00 33 F0 FF 15 18
20 40 00 33 F0 FF 15 1C 20 40 00 33 F0 8D 45 F0
50 FF 15 20 20 40 00 8B 45 F4 33 45 F0 33 F0 3B
F7 75 07 BE 4F E6 40 BB EB 0B 85 F3 75 07 8B C6
C1 E0 10 0B F0 89 35 00 30 40 00 F7 D6 89 35 04
30 40 00 5E 5F 5B C9 C3 FF 25 68 20 40 00 FF 25
6C 20 40 00 FF 25 70 20 40 00 FF 25 74 20 40 00
FF 25 80 20 40 00 FF 25 84 20 40 00 FF 25 88 20
40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00" mutable="false"
          /> 

          <!--  .rdata - starts at file offset 0xE00, has Virtual Address of 0x2000.
                this one contains the import and debug directory. 
                  import @ 0x1024-0x1048
                  debug  @ 0xee0-0xef8
                so, import's RVA was 0x2224 sz 0x3C
                    debug's  RVA     0x20E0 sz 0x1C
                imports will be located at (its RVA - rdata_RVA) + rdata_file_offset
                and debug will be physically found with the same formula
                imports @ (0x2224 - 0x2000) + 0xE00 = 0x1024
                debug   @ (0x20E0 - 0x2000) + 0xE00 = 0xEE0 
          -->
        <Blob name="rdata_pad0" length="1792" valueType="hex" 
          value="20 23 00 00 32 23 00 00 3E 23 00 00 46 23 00 00
54 23 00 00 14 26 00 00 FE 25 00 00 EE 25 00 00
D4 25 00 00 C0 25 00 00 A2 25 00 00 86 25 00 00
72 25 00 00 5E 25 00 00 40 25 00 00 2A 25 00 00
2A 26 00 00 00 00 00 00 12 24 00 00 20 24 00 00
36 24 00 00 4A 24 00 00 5A 24 00 00 6A 24 00 00
06 24 00 00 8A 24 00 00 9C 24 00 00 B2 24 00 00
BC 24 00 00 CA 24 00 00 D2 24 00 00 DC 24 00 00
EE 24 00 00 08 25 00 00 1A 25 00 00 F8 23 00 00
F0 23 00 00 E2 23 00 00 DA 23 00 00 D0 23 00 00
BE 23 00 00 B0 23 00 00 94 23 00 00 8C 23 00 00
80 23 00 00 70 23 00 00 78 24 00 00 00 00 00 00
00 00 00 00 1E 11 40 00 00 00 00 00 00 00 00 00
DF 12 40 00 00 00 00 00 00 00 00 00 00 00 00 00" 
          mutable="false" />

        <!-- 0xEE0:  here's the debug table! TODO: parse -->
        <Blob name="rdata_debugdir" length="224" valueType="hex" 
          value="00 00 00 00 BD AE 88 47 00 00 00 00 02 00 00 00
58 00 00 00 58 21 00 00 58 0F 00 00"
          />

        <Blob name="rdata_pad1" length="2368" valueType="hex" 
          value="38 30 40 00 90 30 40 00 25 00 58 00 00 00 00 00
00 00 00 00 48 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 30 40 00 B0 21 40 00 01 00 00 00 52 53 44 53
D2 84 08 7A 63 BB 93 4F AF D7 7B 3C 2F 7C B5 2D
05 00 00 00 64 3A 5C 4D 79 20 44 6F 63 75 6D 65
6E 74 73 5C 4D 79 20 50 72 6F 6A 65 63 74 73 5C
46 61 6C 6C 6F 75 74 5C 56 53 57 69 6E 33 32 5C
52 65 6C 65 61 73 65 5C 56 53 57 69 6E 33 32 2E
70 64 62 00 25 17 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 FE FF FF FF
00 00 00 00 D0 FF FF FF 00 00 00 00 FE FF FF FF
8F 12 40 00 A3 12 40 00 00 00 00 00 FE FF FF FF
00 00 00 00 CC FF FF FF 00 00 00 00 FE FF FF FF
00 00 00 00 6C 15 40 00 00 00 00 00 FE FF FF FF
00 00 00 00 D8 FF FF FF 00 00 00 00 FE FF FF FF
98 16 40 00 AC 16 40 00" mutable="false" />
        <!-- 0x1024: here's the imports table! TODO: parse -->
        <Blob name="rdata_importdir" length="320" valueType="hex"
          value="60 22 00 00 00 00 00 00 00 00 00 00 62 23 00 00
00 20 00 00 A8 22 00 00 00 00 00 00 00 00 00 00
A4 23 00 00 48 20 00 00"
          />

        <Blob name="rdata_pad2" length="11680" valueType="hex"
          value="00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 20 23 00 00 32 23 00 00 3E 23 00 00
46 23 00 00 54 23 00 00 14 26 00 00 FE 25 00 00
EE 25 00 00 D4 25 00 00 C0 25 00 00 A2 25 00 00
86 25 00 00 72 25 00 00 5E 25 00 00 40 25 00 00
2A 25 00 00 2A 26 00 00 00 00 00 00 12 24 00 00
20 24 00 00 36 24 00 00 4A 24 00 00 5A 24 00 00
6A 24 00 00 06 24 00 00 8A 24 00 00 9C 24 00 00
B2 24 00 00 BC 24 00 00 CA 24 00 00 D2 24 00 00
DC 24 00 00 EE 24 00 00 08 25 00 00 1A 25 00 00
F8 23 00 00 F0 23 00 00 E2 23 00 00 DA 23 00 00
D0 23 00 00 BE 23 00 00 B0 23 00 00 94 23 00 00
8C 23 00 00 80 23 00 00 70 23 00 00 78 24 00 00
00 00 00 00 1B 03 53 65 74 46 69 6C 65 50 6F 69
6E 74 65 72 00 00 A4 03 57 72 69 74 65 46 69 6C
65 00 56 03 53 6C 65 65 70 00 56 00 43 72 65 61
74 65 46 69 6C 65 57 00 34 00 43 6C 6F 73 65 48
61 6E 64 6C 65 00 4B 45 52 4E 45 4C 33 32 2E 64
6C 6C 00 00 10 00 3F 3F 33 40 59 41 58 50 41 58
40 5A 00 00 73 05 73 77 73 63 61 6E 66 5F 73 00
B7 04 5F 77 74 6F 6C 00 0F 00 3F 3F 32 40 59 41
50 41 58 49 40 5A 00 00 4D 53 56 43 52 38 30 2E
64 6C 6C 00 18 01 5F 61 6D 73 67 5F 65 78 69 74
00 00 FD 00 5F 5F 77 67 65 74 6D 61 69 6E 61 72
67 73 00 00 2F 01 5F 63 65 78 69 74 00 00 7F 01
5F 65 78 69 74 00 67 00 5F 58 63 70 74 46 69 6C
74 65 72 00 D6 04 65 78 69 74 00 00 FE 00 5F 5F
77 69 6E 69 74 65 6E 76 00 00 0A 02 5F 69 6E 69
74 74 65 72 6D 00 0B 02 5F 69 6E 69 74 74 65 72
6D 5F 65 00 3F 01 5F 63 6F 6E 66 69 67 74 68 72
65 61 64 6C 6F 63 61 6C 65 00 E9 00 5F 5F 73 65
74 75 73 65 72 6D 61 74 68 65 72 72 00 00 11 01
5F 61 64 6A 75 73 74 5F 66 64 69 76 00 00 CC 00
5F 5F 70 5F 5F 63 6F 6D 6D 6F 64 65 00 00 D0 00
5F 5F 70 5F 5F 66 6D 6F 64 65 00 00 6D 01 5F 65
6E 63 6F 64 65 5F 70 6F 69 6E 74 65 72 00 E6 00
5F 5F 73 65 74 5F 61 70 70 5F 74 79 70 65 00 00
4E 01 5F 63 72 74 5F 64 65 62 75 67 67 65 72 5F
68 6F 6F 6B 00 00 ED 03 5F 75 6E 6C 6F 63 6B 00
97 00 5F 5F 64 6C 6C 6F 6E 65 78 69 74 00 7C 02
5F 6C 6F 63 6B 00 22 03 5F 6F 6E 65 78 69 74 00
63 01 5F 64 65 63 6F 64 65 5F 70 6F 69 6E 74 65
72 00 76 01 5F 65 78 63 65 70 74 5F 68 61 6E 64
6C 65 72 34 5F 63 6F 6D 6D 6F 6E 00 11 02 5F 69
6E 76 6F 6B 65 5F 77 61 74 73 6F 6E 00 00 42 01
5F 63 6F 6E 74 72 6F 6C 66 70 5F 73 00 00 29 02
49 6E 74 65 72 6C 6F 63 6B 65 64 45 78 63 68 61
6E 67 65 00 26 02 49 6E 74 65 72 6C 6F 63 6B 65
64 43 6F 6D 70 61 72 65 45 78 63 68 61 6E 67 65
00 00 5E 03 54 65 72 6D 69 6E 61 74 65 50 72 6F
63 65 73 73 00 00 42 01 47 65 74 43 75 72 72 65
6E 74 50 72 6F 63 65 73 73 00 6E 03 55 6E 68 61
6E 64 6C 65 64 45 78 63 65 70 74 69 6F 6E 46 69
6C 74 65 72 00 00 4A 03 53 65 74 55 6E 68 61 6E
64 6C 65 64 45 78 63 65 70 74 69 6F 6E 46 69 6C
74 65 72 00 39 02 49 73 44 65 62 75 67 67 65 72
50 72 65 73 65 6E 74 00 A3 02 51 75 65 72 79 50
65 72 66 6F 72 6D 61 6E 63 65 43 6F 75 6E 74 65
72 00 DF 01 47 65 74 54 69 63 6B 43 6F 75 6E 74
00 00 46 01 47 65 74 43 75 72 72 65 6E 74 54 68
72 65 61 64 49 64 00 00 43 01 47 65 74 43 75 72
72 65 6E 74 50 72 6F 63 65 73 73 49 64 00 CA 01
47 65 74 53 79 73 74 65 6D 54 69 6D 65 41 73 46
69 6C 65 54 69 6D 65 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00" 
          mutable="false" />

        <!-- 0x1600: data section is uninteresting right? -->
        <Blob name="data_blob" length="4096" valueType="hex" 
          value="4E E6 40 BB B1 19 BF 44 FF FF FF FF FF FF FF FF
FE FF FF FF 01 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00" 
          mutable="false" />
        <!-- 0x1800: here we've got the rsrc dir at the beginning,
             even though section size is 0x200 -->
        <Blob name="rsrc_dir_characteristics" length="32" valueType="hex" value="00 00 00 00" mutable="false"  />
        <Blob name="rsrc_dir_timedatestamp" length="32" valueType="hex" value="00 00 00 00" mutable="false"  />
        <Blob name="rsrc_dir_majorversion" length="16" valueType="hex" value="04 00" mutable="false"  />
        <Blob name="rsrc_dir_minorversion" length="16" valueType="hex" value="00 00" mutable="false"  />
        <Blob name="rsrc_dir_numberofnamedentries" length="16" valueType="hex" value="00 00" />
        <Blob name="rsrc_dir_numberofidentries" length="16" valueType="hex" value="01 00" />

        <Blob name="rsrc_dir_garbage" length="3968" valueType="hex" mutable="false"
          value="18 00 00 00 18 00 00 80 00 00 00 00 00 00 00 00
04 00 00 00 00 00 01 00 01 00 00 00 30 00 00 80
00 00 00 00 00 00 00 00 04 00 00 00 00 00 01 00
09 04 00 00 48 00 00 00 58 40 00 00 52 01 00 00
E4 04 00 00 00 00 00 00 3C 61 73 73 65 6D 62 6C
79 20 78 6D 6C 6E 73 3D 22 75 72 6E 3A 73 63 68
65 6D 61 73 2D 6D 69 63 72 6F 73 6F 66 74 2D 63
6F 6D 3A 61 73 6D 2E 76 31 22 20 6D 61 6E 69 66
65 73 74 56 65 72 73 69 6F 6E 3D 22 31 2E 30 22
3E 0D 0A 20 20 3C 64 65 70 65 6E 64 65 6E 63 79
3E 0D 0A 20 20 20 20 3C 64 65 70 65 6E 64 65 6E
74 41 73 73 65 6D 62 6C 79 3E 0D 0A 20 20 20 20
20 20 3C 61 73 73 65 6D 62 6C 79 49 64 65 6E 74
69 74 79 20 74 79 70 65 3D 22 77 69 6E 33 32 22
20 6E 61 6D 65 3D 22 4D 69 63 72 6F 73 6F 66 74
2E 56 43 38 30 2E 43 52 54 22 20 76 65 72 73 69
6F 6E 3D 22 38 2E 30 2E 35 30 36 30 38 2E 30 22
20 70 72 6F 63 65 73 73 6F 72 41 72 63 68 69 74
65 63 74 75 72 65 3D 22 78 38 36 22 20 70 75 62
6C 69 63 4B 65 79 54 6F 6B 65 6E 3D 22 31 66 63
38 62 33 62 39 61 31 65 31 38 65 33 62 22 3E 3C
2F 61 73 73 65 6D 62 6C 79 49 64 65 6E 74 69 74
79 3E 0D 0A 20 20 20 20 3C 2F 64 65 70 65 6E 64
65 6E 74 41 73 73 65 6D 62 6C 79 3E 0D 0A 20 20
3C 2F 64 65 70 65 6E 64 65 6E 63 79 3E 0D 0A 3C
2F 61 73 73 65 6D 62 6C 79 3E 50 41 50 41 44 44
49 4E 47 58 58 50 41 44 44 49 4E 47 50 41 44 44
49 4E 47 58 58 50 41 44 44 49 4E 47 50 41 44 44
49 4E 47 58 58 50 41 44 44 49 4E 47 50 41 44 44
49 4E 47 58 58 50 41 44 44 49 4E 47 50 41 44 44
49 4E 47 58 58 50 41 44 44 49 4E 47 50 41 44 44"
          />

        <!-- so, according to the PE header that's where our program ends.
             but, an "overlay" in Windows PE is data that comes after the 
             size of the file specified by the PE header. packers, malware
             etc. use this so maybe it's worth fuzzing in certain scenarios.
             overlays are not normally loaded into mem by PE loaders.

             I have no idea what this junk is that was in the templated file.
           -->
        <Blob name="pe_overlay" length="3560" valueType="hex" mutable="false" 
          value="5E 5B 17 FC 70 56 CF 17 9A B2 77 2E 65 5B 98 B8
42 94 B8 32 87 EC 7E B7 B5 6E 16 D1 FC 19 D7 8F
01 90 23 D7 DE 12 8F FE 6A AB 44 96 BC AC A6 87
EA 5A 33 62 16 E3 AD F1 AC 96 7B 13 E5 52 4D C6
90 3F FF 86 11 BD C0 D6 AA 9A 73 1C F9 88 55 B1
C2 CE E0 39 EF 3D F0 30 D5 66 25 C6 B9 0A 88 ED
93 D2 71 B0 11 40 A8 C6 DF E6 CA 67 26 D6 EE 5E
53 59 89 60 19 E4 8F 9C B9 47 DB 93 81 28 D1 2A
92 B0 42 FD E7 84 8F F7 93 F7 12 20 4A 7E B9 B5
23 64 F4 7E 9C BE D2 5C DF A2 67 22 44 94 70 A5
16 41 3A 17 9A 70 BF 90 4D 35 12 EE 6E 67 FE DF
BC 55 EA 3C 81 B5 00 99 CF DD 8F 1A 0A 36 AD 88
A6 ED 20 A3 32 EB 7F BA 96 08 94 7A 99 7B 05 04
A6 95 33 42 CF B0 63 7A 12 62 1C 23 DB F6 CF F8
CB 1C BE 4C B8 DF 16 9D F5 D8 5E 6B D3 A1 15 4A
67 8D 97 37 8E 96 41 28 2F 97 D5 E7 C0 BC 20 1F
0C 36 DA B7 33 33 CD 60 F2 0D 3A 6A 24 C1 78 DC
89 A4 DE C3 C7 51 E3 CA AE E6 84 0B C0 70 E6 25
F1 A3 3D 8F AB CF EC 2C 15 0F EE 1F 95 C4 74 E0
94 41 CF 8F 81 C8 91 89 18 B6 EF 3A E4 FA 6A 32
02 CB AF 7A 29 9B BB 28 E7 46 42 31 2D 90 52 7F
0E CE 34 43 C4 E3 93 8D F4 6E DF 1A 33 42 F4 6C
C8 17 F7 20 B3 7F 81 7D EF 1B 00 49 F5 0E 5A E0
81 B2 D3 87 98 8A 30 FD CA 78 1C 53 B5 30 CC FE
CA ED DF 2B 54 63 88 52 B5 F4 EE 0E F3 26 D3 2C
74 55 74 01 06 A5 B1 01 23 3B 6E 8E 72 AD 39 0E
90 B6 2D 40 11 2F 16 D0 C2 3A D6 29 31 C1 07 8A
70 1F E1 5C 15 1C 5E C3 85 1F 9D 73 73"
          />

        <!-- last finished editing here -->
    </DataModel>
    <!-- Define a simple state machine that will write the file and
  then launch a program using the FileWriterLauncher publisher -->
    <StateModel name="State" initialState="Initial">
        <State name="Initial">
            <Action type="output">
              <DataModel ref="FileData" />
            </Action>
            
            <Action type="close" />
            <!-- Launch the file consumer 
            <Action type="call" method="ida.exe" publisher="launch" />
            -->
        </State>
    </StateModel>
    <!--
    <Agent name="LocalAgent" location="http://127.0.0.1:9000">
        <Monitor class="debugger.WindowsDebugEngine">
            <Param name="ProcessName" value="idag.exe" />
        </Monitor>
    </Agent>
  -->
    <Test name="go">
        
        <Logger class="logger.Filesystem">
            <Param name="Path" value="logs" />
        </Logger>
      
      
        <!--<Agent ref="LocalAgent" />-->
        <StateModel ref="State" />
        <!-- Configure our publisher with correct filename to write to -->
        <Publisher class="FilePerIteration">
          <Param name="FileName" value="tests_exe/fuzzed_{0}.exe" />
        </Publisher>
        <!--
        <Publisher class="process.DebuggerLauncherGui" name="launch">
            <Param name="windowName" value="IDA" />
        </Publisher>
      -->

        <!-- 
          right, so, this is fucking stupid. peach doesn't respect mutable=false
          when deciding if it should fuzz a field. we have to declare the mutable=false
          fields here.
          you might think "hey if they're marked as a token they won't get fuzzed"
          but then the element's value MUST match in the sample corpus file being used.
          which sucks...

          so, run this perl script to generate this list:
         -->
          <Exclude ref="e_cblp" />
          <Exclude ref="e_cp" />
          <Exclude ref="e_crlc" />
          <Exclude ref="e_cparhdr" />
          <Exclude ref="e_minalloc" />
          <Exclude ref="e_maxalloc" />
          <Exclude ref="e_ss" />
          <Exclude ref="e_sp" />
          <Exclude ref="e_csum" />
          <Exclude ref="e_ip" />
          <Exclude ref="e_cs" />
          <Exclude ref="e_lfarlc" />
          <Exclude ref="e_ovno" />
          <Exclude ref="e_res" />
          <Exclude ref="pad0" />
          <Exclude ref="e_oemid" />
          <Exclude ref="e_oeminfo" />
          <Exclude ref="e_res2" />
          <Exclude ref="pad1" />
          <Exclude ref="e_lfanew" />
          <Exclude ref="garbage0" />
          <Exclude ref="Signature" />
          <Exclude ref="Machine" />
          <Exclude ref="TimeDateStamp" />
          <Exclude ref="PointerToSymbolTable" />
          <Exclude ref="NumberOfSymbols" />
          <Exclude ref="Characteristics" />
          <Exclude ref="Magic" />
          <Exclude ref="MajorLinkerVersion" />
          <Exclude ref="MinorLinkerVersion" />
          <Exclude ref="BaseOfCode" />
          <Exclude ref="BaseOfData" />
          <Exclude ref="SectionAlignment" />
          <Exclude ref="FileAlignment" />
          <Exclude ref="MajorOperatingSystemVersion" />
          <Exclude ref="MinorOperatingSystemVersion" />
          <Exclude ref="MajorImageVersion" />
          <Exclude ref="MinorImageVersion" />
          <Exclude ref="MajorSubsystemVersion" />
          <Exclude ref="MinorSubsystemVersion" />
          <Exclude ref="Win32VersionValue" />
          <Exclude ref="CheckSum" />
          <Exclude ref="Subsystem" />
          <Exclude ref="DllCharacteristics" />
          <Exclude ref="SizeOfStackReserve" />
          <Exclude ref="SizeOfStackCommit" />
          <Exclude ref="SizeOfHeapReserve" />
          <Exclude ref="SizeOfHeapCommit" />
          <Exclude ref="LoaderFlags" />
          <Exclude ref="ArchitectureRVA" />
          <Exclude ref="ArchitectureSize" />
          <Exclude ref="TLSRVA" />
          <Exclude ref="TLSSize" />
          <Exclude ref="ConfigRVA" />
          <Exclude ref="ConfigSize" />
          <Exclude ref="BoundRVA" />
          <Exclude ref="BoundSize" />
          <Exclude ref="DelayRVA" />
          <Exclude ref="DelaySize" />
          <Exclude ref="DotNetRVA" />
          <Exclude ref="DotNetSize" />
          <Exclude ref="pad2" />
          <Exclude ref="text_reloc_addr" />
          <Exclude ref="text_linenums" />
          <Exclude ref="text_relocnums" />
          <Exclude ref="text_linenumssize" />
          <Exclude ref="text_characteristics" />
          <Exclude ref="rdata_reloc_addr" />
          <Exclude ref="rdata_linenums" />
          <Exclude ref="rdata_relocnums" />
          <Exclude ref="rdata_linenumssize" />
          <Exclude ref="rdata_characteristics" />
          <Exclude ref="data_reloc_addr" />
          <Exclude ref="data_linenums" />
          <Exclude ref="data_relocnums" />
          <Exclude ref="data_linenumssize" />
          <Exclude ref="data_characteristics" />
          <Exclude ref="rsrc_reloc_addr" />
          <Exclude ref="rsrc_linenums" />
          <Exclude ref="rsrc_relocnums" />
          <Exclude ref="rsrc_linenumssize" />
          <Exclude ref="rsrc_characteristics" />
          <Exclude ref="padding_after_sections" />
          <Exclude ref="text_blob" />
          <Exclude ref="rdata_pad0" />
          <Exclude ref="rdata_pad1" />
          <Exclude ref="rdata_pad2" />
          <Exclude ref="data_blob" />
          <Exclude ref="rsrc_dir_characteristics" />
          <Exclude ref="rsrc_dir_timedatestamp" />
          <Exclude ref="rsrc_dir_majorversion" />
          <Exclude ref="rsrc_dir_minorversion" />
          <Exclude ref="rsrc_dir_garbage" />
          <Exclude ref="pe_overlay" />

    </Test>
    <!--
    <Run name="DefaultRun">
        <Test ref="TheTest" />

    </Run>
    -->
</Peach>
<!-- end -->
